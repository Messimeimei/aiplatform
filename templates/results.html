{% extends "base.html" %}
{% block title %}检索结果{% endblock %}
{% block container_class %}container py-3{% endblock %}

{% block extra_head %}
<style>
  .results-surface{ background:#fff; color:#212529; border-radius:14px; padding:16px; box-shadow:0 8px 24px rgba(0,0,0,.08); }
  .results-surface .card{ background:#fff; }
  .results-surface .alert{ background:#f8f9fa; color:#212529; }
  .results-surface .card .text-muted{ color:#6c757d !important; }
</style>
{% endblock %}

{% block content %}
<div class="results-surface">
  <h1 class="h4 mb-3 text-dark">检索结果</h1>

  <div class="alert border">
    <div class="row g-2 align-items-center">
      <div class="col-auto">
        <span class="badge bg-primary">
          {{ (type_ or request.args.get('type','tech')) == 'product' and '关键产品' or '关键技术' }}
        </span>
      </div>
      <div class="col">
        <strong>关键词：</strong><span class="text-dark">{{ q or request.args.get('q','') }}</span>
      </div>
      <div class="col-auto">
        <a href="{{ url_for('index') }}" class="btn btn-sm btn-outline-secondary">返回修改</a>
      </div>
    </div>
  </div>

  <!-- 有 items：用真实结果渲染 -->
  {% if items %}
  <div class="row row-cols-1 row-cols-md-2 g-3">
    {% for item in items %}
    <div class="col">
      <div class="card h-100 shadow-sm border-0">
        <div class="card-body">
          <h5 class="card-title mb-1 text-dark">{{ item.name }}</h5>
          <div class="small text-muted mb-2">{{ item.kind }} · {{ item.org }} · {{ item.date }}</div>
          <p class="card-text text-dark">{{ item.abstract }}</p>
          <div class="d-flex gap-2">
            <!-- ✅ 详情页跳转 -->
            <a href="{{ url_for('detail_page', item_id=item.id) }}" class="btn btn-sm btn-primary">详情</a>
            <!-- （可选）来源 -->
            <a href="#" class="btn btn-sm btn-outline-secondary">来源</a>
          </div>
        </div>
      </div>
    </div>
    {% endfor %}
  </div>

  {% else %}
  <!-- 没有 items：回退到演示列表 -->
  <div class="row row-cols-1 row-cols-md-2 g-3">
    {% for i in range(6) %}
    <div class="col">
      <div class="card h-100 shadow-sm border-0">
        <div class="card-body">
          <h5 class="card-title mb-1 text-dark">示例结果 #{{ i+1 }}</h5>
          <div class="small text-muted mb-2">机构 · 2024-09</div>
          <p class="card-text text-dark">这里展示摘要/简介……</p>
          <div class="d-flex gap-2">
            <a href="{{ url_for('detail_page', item_id=i+1) }}" class="btn btn-sm btn-primary">详情</a>
            <a href="#" class="btn btn-sm btn-outline-secondary">来源</a>
          </div>
        </div>
      </div>
    </div>
    {% endfor %}
  </div>
  {% endif %}

  <!-- 分页（示例） -->
  <nav class="mt-3" aria-label="分页">
    <ul class="pagination pagination-sm mb-0">
      <li class="page-item disabled"><span class="page-link">上一页</span></li>
      <li class="page-item active"><span class="page-link">1</span></li>
      <li class="page-item">
        <a class="page-link" href="?q={{ q or request.args.get('q','') }}&type={{ type_ or request.args.get('type','tech') }}&page=2">2</a>
      </li>
      <li class="page-item"><a class="page-link" href="#">下一页</a></li>
    </ul>
  </nav>
</div>
{% endblock %}
